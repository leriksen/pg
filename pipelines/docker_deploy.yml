variables:
  - group: devops-dev
  - group: pg-dev

pool:
  vmImage: ubuntu-22.04

trigger: none

stages:
  - stage: Build
    displayName: Build and push stage
    jobs:
      - job: Build
        displayName: Build job
        steps:
          - task: Docker@2
            displayName: Build and push an image to container registry
            inputs:
              command: buildAndPush
              repository: postgres
              dockerfile: $(Build.SourcesDirectory)/docker/Dockerfile
              containerRegistry: $(acr_service_connection)
              tags: |
                0.0.1-$(Build.BuildId)
                0.0.1:latest